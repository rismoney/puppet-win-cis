Facter.add(:<%= fact_name %>) do
  confine :kernel => :windows
  setcode do
    require 'win32/registry'
    key = '<%= registry_key %>'
    keyname = '<%= registry_keyname %>'
    KEY_WOW64_64KEY = 0x100 unless defined? KEY_WOW64_64KEY
    reg_type = Win32::Registry::KEY_READ | KEY_WOW64_64KEY
    begin
      Win32::Registry::<%= registry_hive %>.open(key, reg_type) do |reg| ;
		reg[keyname] == <%=registry_keyvalue %> ? <%= fact_name %>="yes" : <%= fact_name %>="no"
      end
    rescue
      <%= fact_name %>='n/a'
    end
  end
end
